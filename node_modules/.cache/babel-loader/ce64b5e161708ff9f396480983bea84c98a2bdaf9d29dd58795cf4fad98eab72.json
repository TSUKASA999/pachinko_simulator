{"ast":null,"code":"import React,{useRef,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Display=function Display(props){var normalHit=1;//通常時大当たり\nvar kakuhenHit=1;var speedOfNormalShoot=Number(process.env.REACT_APP_SPEED_OF_NORMAL_SHOOT);var speedOfQuickShoot=Number(process.env.REACT_APP_SPEED_OF_QUICK_SHOOT);var isQuickRef=useRef(props.isQuick);isQuickRef.current=props.isQuick;var creditsRef=useRef(props.credits);creditsRef.current=props.credits;var startRef=useRef(props.start);startRef.current=props.start;var totalStartRef=useRef(props.totalStart);totalStartRef.current=props.totalStart;var isKakuhen=function isKakuhen(){var data={'確変':props.weightOfChanceTime,'通常':props.weightOfNotChanceTime};var rand=Math.floor(Math.random()*100);var rate=0;for(var prop in data){rate+=data[prop];if(rand<=rate){window.alert('通常');break;}else{window.alert('確変');props.setIsChanceTime(true);break;}}};var kakuhenLottery=function kakuhenLottery(){props.setStart(startRef.current+1);props.setTotalStart(totalStartRef.current+1);var number=Math.floor(Math.random()*props.probabilityOfRight);if(kakuhenHit===number){window.alert('BONUS');clearInterval();props.setFlg(false);bonusLottery();}else{console.log('NEXT');}};var bonusLottery=function bonusLottery(){var data={'SUPER BIG BONUS':props.weightOfSBB,//SBの確率\n'BIG BONUS':props.weightOfBB//BBの確率\n//100 - SB -BB = RBの確率\n};var rand=Math.floor(Math.random()*100);var result='';var rate=0;for(var prop in data){rate+=data[prop];if(rand<=rate){result=prop;break;}else{result='BONUS';}}props.setBonusTime(props.bonusTimes+1);switch(result){case'SUPER BIG BONUS':window.alert('SUPER BIG BONUS');props.setMochidama(props.mochidama+props.superBigBonus);break;case'BIG BONUS':window.alert('BIG BONUS');props.setMochidama(props.mochidama+props.bigBonus);break;case'BONUS':props.setMochidama(props.mochidama+props.regularBonus);props.setIsChanceTime(false);window.alert('左打ちに戻してくれ');break;default:window.alert('係員を呼んでください');}props.setStart(0);};// n回転/1kの処理\nvar normalHandle=function normalHandle(){if(creditsRef.current<=0){window.alert('玉がありません');clearInterval();props.setFlg(false);return;}else{props.setCredit(creditsRef.current-1);var number=Math.floor(Math.random()*10);if(number===normalHit){normalLottery();}}};// 通常時の抽選\nvar normalLottery=function normalLottery(){var number=Math.floor(Math.random()*props.probabilityOfLeft);if(number===normalHit){clearInterval();props.setFlg(false);window.alert('大当たり!');props.setMochidama(props.mochidama+props.leftBonus);props.setBonusTime(props.bonusTimes+1);isKakuhen();props.setStart(0);}else{console.log('next');props.setStart(startRef.current+1);}props.setTotalStart(totalStartRef.current+1);};var interval=null;useEffect(function(){if(props.flg){console.log('開始');interval=setInterval(function(){if(!props.isChanceTime){normalHandle();}else{kakuhenLottery();}},isQuickRef.current?speedOfQuickShoot:speedOfNormalShoot);return function(){console.log('停止');clearInterval(interval);};}},[props.flg,isQuickRef.current]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return props.setFlg(!props.flg);},className:props.flg?'active handle':'handle',children:\"handle\"}),/*#__PURE__*/_jsx(\"div\",{className:\"display\",children:props.isChanceTime?'確変':'通常'})]});};export default Display;","map":{"version":3,"names":["React","useRef","useEffect","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Display","props","normalHit","kakuhenHit","speedOfNormalShoot","Number","process","env","REACT_APP_SPEED_OF_NORMAL_SHOOT","speedOfQuickShoot","REACT_APP_SPEED_OF_QUICK_SHOOT","isQuickRef","isQuick","current","creditsRef","credits","startRef","start","totalStartRef","totalStart","isKakuhen","data","weightOfChanceTime","weightOfNotChanceTime","rand","Math","floor","random","rate","prop","window","alert","setIsChanceTime","kakuhenLottery","setStart","setTotalStart","number","probabilityOfRight","clearInterval","setFlg","bonusLottery","console","log","weightOfSBB","weightOfBB","result","setBonusTime","bonusTimes","setMochidama","mochidama","superBigBonus","bigBonus","regularBonus","normalHandle","setCredit","normalLottery","probabilityOfLeft","leftBonus","interval","flg","setInterval","isChanceTime","children","onClick","className"],"sources":["C:/Users/ncbm9/OneDrive/ドキュメント/GitHub/pachinko_simulator/src/components/Display.jsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react'\r\n\r\nconst Display = (props) => {\r\n    const normalHit = 1;//通常時大当たり\r\n    const kakuhenHit = 1;\r\n\r\n    const speedOfNormalShoot = Number(process.env.REACT_APP_SPEED_OF_NORMAL_SHOOT)\r\n    const speedOfQuickShoot = Number(process.env.REACT_APP_SPEED_OF_QUICK_SHOOT)\r\n\r\n    const isQuickRef = useRef(props.isQuick)\r\n    isQuickRef.current = props.isQuick\r\n    const creditsRef = useRef(props.credits)\r\n    creditsRef.current = props.credits\r\n    const startRef = useRef(props.start)\r\n    startRef.current = props.start\r\n    const totalStartRef = useRef(props.totalStart)\r\n    totalStartRef.current = props.totalStart\r\n\r\n    const isKakuhen = () => {\r\n        const data = { '確変': props.weightOfChanceTime, '通常': props.weightOfNotChanceTime }\r\n        const rand = Math.floor(Math.random() * 100)\r\n        let rate = 0\r\n        for (const prop in data) {\r\n            rate += data[prop]\r\n            if (rand <= rate) {\r\n                window.alert('通常')\r\n                break\r\n            } else {\r\n                window.alert('確変')\r\n                props.setIsChanceTime(true)\r\n                break\r\n            }\r\n        }\r\n    }\r\n\r\n    const kakuhenLottery = () => {\r\n        props.setStart(startRef.current + 1)\r\n        props.setTotalStart(totalStartRef.current + 1)\r\n        const number = Math.floor(Math.random() * props.probabilityOfRight)\r\n        if (kakuhenHit === number) {\r\n            window.alert('BONUS')\r\n            clearInterval()\r\n            props.setFlg(false)\r\n            bonusLottery()\r\n        } else {\r\n            console.log('NEXT')\r\n        }\r\n    }\r\n\r\n    const bonusLottery = () => {\r\n        const data = {\r\n            'SUPER BIG BONUS': props.weightOfSBB,//SBの確率\r\n            'BIG BONUS': props.weightOfBB,//BBの確率\r\n            //100 - SB -BB = RBの確率\r\n        }\r\n        const rand = Math.floor(Math.random() * 100)\r\n        let result = '';\r\n        let rate = 0\r\n        for (const prop in data) {\r\n            rate += data[prop]\r\n            if (rand <= rate) {\r\n                result = prop;\r\n                break\r\n            } else {\r\n                result = 'BONUS'\r\n            }\r\n        }\r\n\r\n        props.setBonusTime(props.bonusTimes + 1);\r\n\r\n        switch (result) {\r\n            case 'SUPER BIG BONUS':\r\n                window.alert('SUPER BIG BONUS')\r\n                props.setMochidama(props.mochidama + props.superBigBonus)\r\n                break;\r\n            case 'BIG BONUS':\r\n                window.alert('BIG BONUS')\r\n                props.setMochidama(props.mochidama + props.bigBonus)\r\n                break;\r\n            case 'BONUS':\r\n                props.setMochidama(props.mochidama + props.regularBonus)\r\n                props.setIsChanceTime(false)\r\n                window.alert('左打ちに戻してくれ')\r\n                break;\r\n            default:\r\n                window.alert('係員を呼んでください')\r\n        }\r\n        props.setStart(0)\r\n    }\r\n\r\n    // n回転/1kの処理\r\n    const normalHandle = () => {\r\n        if (creditsRef.current <= 0) {\r\n            window.alert('玉がありません')\r\n            clearInterval()\r\n            props.setFlg(false)\r\n            return\r\n        } else {\r\n            props.setCredit(creditsRef.current - 1)\r\n            const number = Math.floor(Math.random() * 10)\r\n            if (number === normalHit) {\r\n                normalLottery()\r\n            }\r\n        }\r\n    }\r\n\r\n    // 通常時の抽選\r\n    const normalLottery = () => {\r\n        const number = Math.floor(Math.random() * props.probabilityOfLeft)\r\n        if (number === normalHit) {\r\n            clearInterval()\r\n            props.setFlg(false)\r\n            window.alert('大当たり!')\r\n            props.setMochidama(props.mochidama + props.leftBonus)\r\n            props.setBonusTime(props.bonusTimes + 1)\r\n            isKakuhen();\r\n            props.setStart(0)\r\n        } else {\r\n            console.log('next')\r\n            props.setStart(startRef.current + 1)\r\n        }\r\n        props.setTotalStart(totalStartRef.current + 1)\r\n    }\r\n\r\n\r\n    let interval = null\r\n\r\n    useEffect(() => {\r\n        if (props.flg) {\r\n            console.log('開始')\r\n            interval = setInterval(() => {\r\n                if (!props.isChanceTime) {\r\n                    normalHandle()\r\n                } else {\r\n                    kakuhenLottery()\r\n                }\r\n            },\r\n                isQuickRef.current ? speedOfQuickShoot : speedOfNormalShoot\r\n            )\r\n            return () => {\r\n                console.log('停止')\r\n                clearInterval(interval)\r\n            }\r\n        }\r\n    }, [props.flg, isQuickRef.current])\r\n\r\n\r\n    return (\r\n        <>\r\n            <button onClick={() => props.setFlg(!props.flg)} className={props.flg ? 'active handle' : 'handle'}>handle</button>\r\n            <div className='display'>\r\n                {props.isChanceTime\r\n                    ?\r\n                    '確変'\r\n                    :\r\n                    '通常'\r\n                }\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Display"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}